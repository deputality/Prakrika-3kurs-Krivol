jQuery(document).ready(function(u){function f(){this.length=8,this.timestamp=+new Date;this.generate=function(){for(var e,a,d=this.timestamp.toString().split("").reverse(),i="",l=0;l<this.length;++l)i+=d[e=0,a=d.length-1,Math.floor(Math.random()*(a-e+1))+e];return i}}u(document).on("keyup change","[data-pafe-form-builder-image-upload]",function(){var d=u(this).closest("label"),t=u(this).closest(".elementor-element"),o=1e3,r=u(this)[0].files,e=u(this).data("pafe-form-id");let p=u('button[data-pafe-form-builder-submit-form-id="'+e+'"]');p.prop("disabled",!0),p.css("opacity","0.6"),void 0!==d.attr("data-pafe-form-builder-image-upload-max-files")&&(o=parseInt(d.attr("data-pafe-form-builder-image-upload-max-files")),e=t.find(".pafe-form-builder-image-upload-placeholder.pafe-form-builder-image-upload-uploaded:not(.pafe-form-builder-image-upload-delete)").length,o-=e),u.each(u(this)[0].files,function(i,e){var l,a;0<o?(--o,"gif"!=(a=(a=e.name).substring(a.lastIndexOf(".")+1).toLowerCase())&&"png"!=a&&"jpg"!=a&&"jpeg"!=a||("undefined"!=typeof FileReader?("multiple"!=d.attr("multiple")&&d.hide(0),l=(new f).generate(),(a=new FileReader).onload=function(e){image=new Image,image.src=e.target.result,d.before('<div class="pafe-form-builder-image-upload-placeholder pafe-form-builder-image-upload-uploading" style="background-image:url('+e.target.result+')" data-pafe-form-builder-image-upload-placeholder="'+l+'"><input type="text" style="display:none;" data-pafe-form-builder-image-upload-item><span class="pafe-form-builder-image-upload-button pafe-form-builder-image-upload-button--remove" data-pafe-form-builder-image-upload-button-remove><i class="fa fa-times" aria-hidden="true"></i></span><span class="pafe-form-builder-image-upload-button pafe-form-builder-image-upload-button--uploading" data-pafe-form-builder-image-upload-button-uploading><i class="fa fa-spinner fa-spin"></i></span></div>')},a.readAsDataURL(e),(a=new FormData).append("upload",e),u.ajax({url:u("[data-pafe-form-builder-tinymce-upload]").data("pafe-form-builder-tinymce-upload"),type:"POST",data:a,processData:!1,contentType:!1,success:function(e){var a,d=JSON.parse(e),e=u(document).find('[data-pafe-form-builder-image-upload-placeholder="'+l+'"]');1==e.length&&(e.removeClass("pafe-form-builder-image-upload-uploading").addClass("pafe-form-builder-image-upload-uploaded"),e.find("input").attr("value",d.location),a="",t.find("[data-pafe-form-builder-image-upload-placeholder]:not(.pafe-form-builder-image-upload-delete) [data-pafe-form-builder-image-upload-item]").each(function(){a+=u(this).val()+","}),a=a.replace(/.$/,""),t.find("[data-pafe-form-builder-form-id]").attr("value",a),t.find("[data-pafe-form-builder-form-id]").val(a),t.find("[data-pafe-form-builder-form-id]").change(),i+1===r.length&&(p.prop("disabled",!1),p.css("opacity","1")))}})):alert("Your browser does not support")),0==o&&d.hide(0)):d.hide(0)})}),u(document).on("click","[data-pafe-form-builder-image-upload-button-remove]",function(){var e=u(this).closest(".pafe-form-builder-image-upload-placeholder");e.css({display:"none"}),e.addClass("pafe-form-builder-image-upload-delete");var a=u(this).closest(".elementor-element"),d=a.find("[data-pafe-form-builder-image-upload-placeholder]:not(.pafe-form-builder-image-upload-delete) [data-pafe-form-builder-image-upload-item]"),i="",e=a.find("[data-pafe-form-builder-image-upload-label]");0==d.length&&e.show(0),"multiple"==e.attr("multiple")&&e.show(0),d.each(function(){i+=u(this).val()+","}),i=i.replace(/.$/,""),a.find("[data-pafe-form-builder-form-id]").val(i),a.find("[data-pafe-form-builder-form-id]").change()})});